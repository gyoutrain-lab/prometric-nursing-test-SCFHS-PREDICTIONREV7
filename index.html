<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>SCFHS STR Simulator - 50 Questions</title>
<style>
  body { font-family: Arial, sans-serif; margin: 20px; }
  .question { margin-bottom: 20px; padding: 10px; border: 1px solid #ccc; border-radius: 5px; }
  .options button { margin: 5px; padding: 5px 10px; }
  .rationale { display: none; background: #f0f0f0; padding: 5px; border-radius: 3px; margin-top: 5px; }
  .heat { display: inline-block; width: 25px; height: 25px; margin: 2px; line-height: 25px; text-align: center; background: #eee; border-radius: 3px; cursor: default; }
  .heat.correct { background: #4CAF50; color: white; }
  .heat.incorrect { background: #f44336; color: white; }
</style>
</head>
<body>
<h1>SCFHS STR Simulator - 50 Questions</h1>
<label>Enter Name/ID: <input type="text" id="studentName"></label><br><br>

<div id="quizContainer"></div>

<h2>Heatmap</h2>
<div id="heatmap"></div><br>

<button id="submit-all">Submit All & Show Go/Not Go</button>

<script>
function shuffleArray(array) {
  for (let i = array.length -1; i > 0; i--) {
    let j = Math.floor(Math.random()*(i+1));
    [array[i], array[j]] = [array[j], array[i]];
  }
  return array;
}

// === 50 questions with specific rationales ===
// For brevity, Q51-Q100 same as previous; Q51-Q100 follow similar structure
let questions = [
  {q:"Q51: 70yo post-op hypotension, tachycardia. First action?", options:["Call physician","Administer IV fluids","Give O2","Monitor vitals"], correct:1, rationale:"IV fluids restore perfusion."},
  {q:"Q52: Patient SOB, crackles, SpO2 85%. Action?", options:["Call physician","Give O2","Stop IV","Start diuretics"], correct:1, rationale:"Oxygen is immediate priority."},
  {q:"Q53: ABG for ICU patient. Correct artery?", options:["Radial","Femoral","Carotid","Brachial"], correct:0, rationale:"Radial artery is safest."},
  {q:"Q54: Hypoglycemic, responsive. Action?", options:["Give IV dextrose","Give oral glucose","Monitor","Call physician"], correct:1, rationale:"Oral glucose is safe for conscious patient."},
  {q:"Q55: Pulseless, unresponsive. Nurse action?", options:["Start CPR","Check BP","Administer epinephrine","Wait"], correct:0, rationale:"CPR immediately preserves life."},
  {q:"Q56: NG feeding, aspiration risk. Action?", options:["Keep HOB elevated","Flush q24h","Check vitals only","Medicate together"], correct:0, rationale:"HOB elevation reduces aspiration risk."},
  {q:"Q57: SOB after IV, crackles present. Nurse first action?", options:["Stop IV","Give O2","Call physician","Monitor"], correct:0, rationale:"Stop IV prevents further overload."},
  {q:"Q58: Stroke patient with dysphagia. Priority?", options:["Flush NG","Elevate HOB","Monitor residuals","Check glucose"], correct:1, rationale:"Elevating HOB prevents aspiration."},
  {q:"Q59: ABG sampling. Most common artery?", options:["Radial","Brachial","Femoral","Carotid"], correct:0, rationale:"Radial artery is standard."},
  {q:"Q60: Hypoglycemic, LOC. Nurse action?", options:["Give oral glucose","Call physician","IV dextrose","Monitor"], correct:2, rationale:"IV dextrose is fastest for unconscious patient."},
  {q:"Q61: Pulseless patient. Immediate?", options:["CPR","Oxygen","Call physician","IV fluids"], correct:0, rationale:"Immediate CPR is life-saving."},
  {q:"Q62: Post-IV fluids, crackles present. Nurse action?", options:["Stop IV","Give O2","Call physician","Monitor"], correct:0, rationale:"Stopping IV prevents worsening fluid overload."},
  {q:"Q63: Post-op hypotension. Priority?", options:["Call physician","Give IV fluids","Monitor only","Pain meds"], correct:1, rationale:"IV fluid restores perfusion."},
  {q:"Q64: SOB, crackles, SpO2 low. First action?", options:["Give O2","Stop IV","Call physician","Start diuretics"], correct:0, rationale:"Oxygenation is immediate priority."},
  {q:"Q65: ABG for ICU patient. Artery?", options:["Radial","Brachial","Femoral","Carotid"], correct:0, rationale:"Radial artery is standard."},
  {q:"Q66: Hypoglycemic, responsive. Action?", options:["Oral glucose","IV dextrose","Monitor only","Call physician"], correct:0, rationale:"Oral glucose is safe for conscious patient."},
  {q:"Q67: Unresponsive, pulseless. Nurse action?", options:["Start CPR","Call physician","Check oxygen","Administer fluids"], correct:0, rationale:"Immediate CPR is life-saving."},
  {q:"Q68: NG feeding patient. Action?", options:["Keep HOB elevated","Flush q24h","Check vitals only","Medicate together"], correct:0, rationale:"Elevation prevents aspiration."},
  {q:"Q69: SOB after IV fluids. Action?", options:["Stop IV","Give O2","Monitor","Call physician"], correct:0, rationale:"Stopping IV prevents further overload."},
  {q:"Q70: Stroke patient dysphagia. Nursing priority?", options:["Flush NG","Elevate HOB","Monitor residuals","Check glucose"], correct:1, rationale:"HOB elevation reduces aspiration risk."},
  {q:"Q71: ICU ABG artery?", options:["Radial","Brachial","Femoral","Carotid"], correct:0, rationale:"Radial artery is safest."},
  {q:"Q72: Hypoglycemic, LOC. Action?", options:["IV dextrose","Oral glucose","Monitor","Call physician"], correct:0, rationale:"IV dextrose is fastest."},
  {q:"Q73: Pulseless, unresponsive. Immediate?", options:["CPR","Oxygen","Call physician","IV fluids"], correct:0, rationale:"Immediate CPR preserves life."},
  {q:"Q74: Post-IV crackles. Nurse action?", options:["Stop IV","Give O2","Monitor","Notify physician"], correct:0, rationale:"Stopping IV prevents worsening pulmonary edema."},
  {q:"Q75: Post-op hypotension. First action?", options:["Give IV fluids","Call physician","Monitor only","Pain meds"], correct:0, rationale:"IV fluids restore perfusion."},
  {q:"Q76: SOB, crackles, SpO2 85%. Nurse action?", options:["Give O2","Stop IV","Call physician","Start diuretics"], correct:0, rationale:"Oxygen corrects hypoxia immediately."},
  {q:"Q77: ABG ICU artery choice?", options:["Radial","Brachial","Femoral","Carotid"], correct:0, rationale:"Radial artery is standard."},
  {q:"Q78: Hypoglycemic, responsive. Action?", options:["Oral glucose","IV dextrose","Monitor","Call physician"], correct:0, rationale:"Oral glucose is appropriate."},
  {q:"Q79: Pulseless, unresponsive. Nurse action?", options:["Start CPR","Call physician","Check oxygen","IV fluids"], correct:0, rationale:"CPR is immediate."},
  {q:"Q80: Post-IV crackles. Action?", options:["Stop IV","Give O2","Monitor","Notify physician"], correct:0, rationale:"Stopping IV prevents worsening fluid overload."},
  {q:"Q81: 56yo post-op hypotension. Priority?", options:["Elevate legs","Give IV fluids","Call physician","Monitor BP"], correct:1, rationale:"IV fluid restores perfusion."},
  {q:"Q82: 65yo sudden SOB, crackles. First action?", options:["Administer O2","Stop IV fluids","Notify physician","Give diuretic"], correct:0, rationale:"Oxygenation is priority."},
  {q:"Q83: 58yo ICU patient needs ABG. Best artery?", options:["Radial","Brachial","Femoral","Carotid"], correct:0, rationale:"Radial artery is preferred for safety."},
  {q:"Q84: 45yo diabetic, hypoglycemic, confused. Immediate action?", options:["Give glucagon IM","Give rapid-acting glucose","Monitor glucose","Call physician"], correct:1, rationale:"Rapid glucose quickly reverses hypoglycemia."},
  {q:"Q85: Unresponsive, no pulse. Next action?", options:["Start CPR","Check BP","Give epinephrine","Wait for physician"], correct:0, rationale:"Immediate CPR follows ACLS protocol."},
  {q:"Q86: 65yo stroke with NG feeding. Priority?", options:["Flush tube q8h","Keep HOB elevated","Check residuals daily","Give meds together"], correct:1, rationale:"Elevating head of bed ≥30° reduces aspiration risk."},
  {q:"Q87: Post-op confusion, low O2. First intervention?", options:["Call physician","Give sedative","Administer O2","Start IV"], correct:2, rationale:"Correcting hypoxia is priority."},
  {q:"Q88: NG tube feeding, ensure safety?", options:["Flush with water","Keep HOB flat","Monitor glucose q24h","Medicate through tube"], correct:0, rationale:"Regular flushing prevents clogging."},
  {q:"Q89: Post-op tachycardia, hypotension. Nurse action?", options:["Give pain meds","Administer IV fluids","Monitor vitals only","Call dietitian"], correct:1, rationale:"Fluid resuscitation treats hypovolemia."},
  {q:"Q90: Crackles after IV fluids. Nurse should?", options:["Stop IV fluids","Give O2","Call physician","Start CPR"], correct:0, rationale:"Stopping fluids prevents worsening pulmonary edema."},
  {q:"Q91: ICU ABG artery choice?", options:["Radial","Brachial","Femoral","Carotid"], correct:0, rationale:"Radial artery is safest."},
  {q:"Q92: Hypoglycemic, LOC. Nurse action?", options:["IV dextrose","Oral glucose","Monitor","Call physician"], correct:0, rationale:"IV dextrose fastest for unconscious patient."},
  {q:"Q93: Pulseless patient. Immediate?", options:["CPR","Oxygen","Call physician","IV fluids"], correct:0, rationale:"Immediate CPR is life-saving."},
  {q:"Q94: Post-IV fluids, crackles present. Nurse action?", options:["Stop IV","Give O2","Call physician","Monitor"], correct:0, rationale:"Stopping IV prevents worsening overload."},
  {q:"Q95: Post-op hypotension. Priority?", options:["Call physician","Give IV fluids","Monitor only","Pain meds"], correct:1, rationale:"IV fluid restores perfusion."},
  {q:"Q96: SOB, crackles, SpO2 low. First action?", options:["Give O2","Stop IV","Call physician","Start diuretics"], correct:0, rationale:"Oxygenation is priority."},
  {q:"Q97: ABG for ICU patient. Artery?", options:["Radial","Brachial","Femoral","Carotid"], correct:0, rationale:"Radial artery is standard."},
  {q:"Q98: Hypoglycemic, responsive. Action?", options:["Oral glucose","IV dextrose","Monitor only","Call physician"], correct:0, rationale:"Oral glucose is safe."},
  {q:"Q99: Pulseless, unresponsive. Nurse action?", options:["Start CPR","Call physician","Check oxygen","IV fluids"], correct:0, rationale:"CPR is immediate."},
  {q:"Q100: Post-IV crackles. Action?", options:["Stop IV","Give O2","Monitor","Notify physician"], correct:0, rationale:"Stopping IV prevents worsening fluid overload."}
];

let quizContainer = document.getElementById("quizContainer");
let heatmapContainer = document.getElementById("heatmap");
let userAnswers = new Array(questions.length);

questions.forEach((qData, index) => {
  let qDiv = document.createElement("div");
  qDiv.className = "question";
  qDiv.innerHTML = `<strong>${qData.q}</strong>`;
  
  let optionsDiv = document.createElement("div");
  optionsDiv.className = "options";
  
  let shuffledOptions = shuffleArray([...qData.options]);
  let correctIndex = shuffledOptions.indexOf(qData.options[qData.correct]);
  
  shuffledOptions.forEach((opt, i) => {
    let btn = document.createElement("button");
    btn.textContent = opt;
    btn.addEventListener("click", () => {
      optionsDiv.querySelectorAll("button").forEach(b => b.disabled = true);
      btn.classList.add(i===correctIndex ? "correct" : "incorrect");
      userAnswers[index] = i===correctIndex;
      rationaleBox.style.display = "block";
      rationaleBox.innerHTML = `<strong>Rationale:</strong> ${qData.rationale}`;
      document.getElementById("heat"+(index+1)).classList.add(i===correctIndex ? "correct" : "incorrect");
    });
    optionsDiv.appendChild(btn);
  });
  
  let rationaleBox = document.createElement("div");
  rationaleBox.className = "rationale";
  qDiv.appendChild(optionsDiv);
  qDiv.appendChild(rationaleBox);
  quizContainer.appendChild(qDiv);
  
  let heatDiv = document.createElement("div");
  heatDiv.className = "heat";
  heatDiv.id = "heat"+(index+1);
  heatDiv.textContent = index+1;
  heatmapContainer.appendChild(heatDiv);
});

document.getElementById("submit-all").addEventListener("click", () => {
  let studentName = document.getElementById("studentName").value.trim();
  if(!studentName) { alert("Enter Name/ID first."); return; }
  let correctCount = userAnswers.filter(a=>a).length;
  let goStatus = correctCount>=70 ? "GO" : "NOT GO"; // threshold adjustable
  alert(`Student: ${studentName}\nScore: ${correctCount}/100\nResult: ${goStatus}`);
});
</script>
</body>
</html>
